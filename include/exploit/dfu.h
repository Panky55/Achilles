#include <AlfieLoader.h>
#include <IOKit/IOKitLib.h>
#include <CoreFoundation/CoreFoundation.h>
#include <usb/usb-utils.h>

#ifndef DFU_H
#define DFU_H

struct dfu_serial_t
{ // CPID:8011 CPRV:10 CPFM:03 SCEP:01 BDID:04 ECID:000C24A8000B883A IBFL:3C SRTG:[iBoot-3135.0.0.2.3]
    int cpid;
    int cprv;
    int cpfm;
    int bdid;
    unsigned long long ecid;
    int ibfl;
    char srtg[0x20];
};

typedef struct dfu_serial_t dfu_serial_t;

struct pwndfu_serial_t
{
    int cpid;
    int cprv;
    int cpfm;
    int bdid;
    unsigned long long ecid;
    int ibfl;
    char srtg[0x20];
    char pwnd[0x20];
};

typedef struct pwndfu_serial_t pwndfu_serial_t;

struct pwndfu_device_t
{
    io_service_t service;
    pwndfu_serial_t serial;
};

typedef struct pwndfu_device_t pwndfu_device_t;

struct dfu_device_t
{
    io_service_t service;
    dfu_serial_t serial;
};

typedef struct dfu_device_t dfu_device_t;

dfu_serial_t parseSerialNumber(char *serialNumber);
pwndfu_serial_t parseSerialNumberPwned(char *serialNumber);



#endif // DFU_H