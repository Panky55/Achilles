#ifndef HELPERS_H
#define HELPERS_H

#include <AlfieLoader.h>
#include <utils/log.h>
#include <stdio.h>
#include <stdint.h>
#include <CoreFoundation/CoreFoundation.h>

#define MAX_BLOCK_SIZE 0x50
#define ARM_16K_TT_L2_SIZE 0x2000000U

typedef struct {
	uint64_t func, arg;
} callback_t;

void asm_arm64_x7_trampoline(uint64_t address, uint8_t *destination);
size_t generateUSBROPCallbacks(uint8_t *buffer, uint64_t address, callback_t *callbacks, size_t callbackCount);
// size_t generateUSBROPCallbacks(uint8_t *buf, uint64_t addr, const callback_t *callbacks, size_t callback_cnt);

#endif // HELPERS_H