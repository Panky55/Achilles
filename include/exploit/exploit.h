#ifndef EXPLOIT_H
#define EXPLOIT_H

#include <IOKit/IOKitLib.h>
#include <CoreFoundation/CoreFoundation.h>
#include <time.h>
#include <utils/log.h>
#include <exploit/dfu.h>
#include <exploit/recovery.h>
#include <usb/usb.h>
#include <usb/device.h>
#include <boot/pongo.h>
#include <boot/pongo_helper.h>

enum ExploitStage {
    STAGE_RESET = 0,
    STAGE_HEAP_SPRAY = 1,
    STAGE_TRIGGER = 2,
    STAGE_PATCH = 3,
    STAGE_DONE = 4,
    STAGE_PONGO = 5
};

// ******************************************************
// Function: checkm8()
//
// Purpose: Perform the checkm8 exploit
//
// Returns:
//      int: 0 if the exploit was successful, -1 if there is an error
// ******************************************************
int checkm8();

#endif // EXPLOIT_H