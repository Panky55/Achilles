#include <exploit/dfu.h>

dfu_serial_t parseSerialNumber(char *serialNumber)
{
    dfu_serial_t dfuSerial;
    sscanf(serialNumber, "CPID:%x CPRV:%x CPFM:%x BDID:%x ECID:%llx IBFL:%x SRTG:[%s]", &dfuSerial.cpid, &dfuSerial.cprv, &dfuSerial.cpfm, &dfuSerial.bdid, &dfuSerial.ecid, &dfuSerial.ibfl, dfuSerial.srtg);
    return dfuSerial;
}

pwndfu_serial_t parseSerialNumberPwned(char *serialNumber)
{
    pwndfu_serial_t dfuSerial;
    sscanf(serialNumber, "CPID:%x CPRV:%x CPFM:%x BDID:%x ECID:%llx IBFL:%x SRTG:[%s] PWND:[%s]", &dfuSerial.cpid, &dfuSerial.cprv, &dfuSerial.cpfm, &dfuSerial.bdid, &dfuSerial.ecid, &dfuSerial.ibfl, dfuSerial.srtg, dfuSerial.pwnd);
    return dfuSerial;
}